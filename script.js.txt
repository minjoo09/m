// í˜ì´ì§€ê°€ ì‹œì‘ë  ë•Œ ì‹¤í–‰ë˜ëŠ” ë¶€ë¶„
document.addEventListener('DOMContentLoaded', function() {
    // localStorageì—ì„œ ì €ì¥ëœ ê¸°íšë“¤ì„ ë¶ˆëŸ¬ì™€ìš”
    loadPlans();
});

// ì €ì¥ ë²„íŠ¼ í´ë¦­í–ˆì„ ë•Œ
document.getElementById('saveBtn').addEventListener('click', function() {
    // ì…ë ¥ëœ ê°’ë“¤ì„ ê°€ì ¸ì™€ìš”
    const title = document.getElementById('title').value;
    const genre = document.getElementById('genre').value;
    const duration = document.getElementById('duration').value;
    const cast = document.getElementById('cast').value;
    const plan = document.getElementById('plan').value;

    // ëª¨ë“  í•„ë“œê°€ ì…ë ¥ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ìš”
    if (!title || !genre || !duration || !cast || !plan) {
        alert('ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”! ğŸ˜Š');
        return;
    }

    // ìƒˆë¡œìš´ ê¸°íš ê°ì²´ë¥¼ ë§Œë“¤ì–´ìš”
    const newPlan = {
        id: Date.now(), // ì‹œê°„ì„ ì´ìš©í•´ì„œ ê³ ìœ í•œ ë²ˆí˜¸ ë§Œë“¤ê¸°
        title: title,
        genre: genre,
        duration: duration,
        cast: cast,
        plan: plan,
        date: new Date().toLocaleDateString('ko-KR')
    };

    // localStorageì—ì„œ ì €ì¥ëœ ê¸°íšë“¤ì„ ê°€ì ¸ì™€ìš”
    let plans = JSON.parse(localStorage.getItem('plans')) || [];
    
    // ìƒˆë¡œìš´ ê¸°íšì„ ëª©ë¡ì— ì¶”ê°€í•´ìš”
    plans.push(newPlan);
    
    // ë‹¤ì‹œ ì €ì¥í•´ìš”
    localStorage.setItem('plans', JSON.stringify(plans));

    // ì…ë ¥ í¼ì„ ë¹„ì›Œìš” (ì´ˆê¸°í™”)
    clearForm();

    // í™”ë©´ì— ë‹¤ì‹œ ë³´ì—¬ì¤˜ìš”
    loadPlans();

    // ì¶•í•˜ ë©”ì‹œì§€ë¥¼ ë„ì›Œìš”
    alert('ê¸°íšì´ ì €ì¥ë˜ì—ˆì–´ìš”! ğŸ‰');
});

// ì €ì¥ëœ ê¸°íšë“¤ì„ í™”ë©´ì— ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜
function loadPlans() {
    // localStorageì—ì„œ ê¸°íšë“¤ì„ ê°€ì ¸ì™€ìš”
    const plans = JSON.parse(localStorage.getItem('plans')) || [];
    const planList = document.getElementById('planList');

    // ê¸°ì¡´ í•­ëª©ë“¤ì„ ëª¨ë‘ ì§€ì›Œìš”
    planList.innerHTML = '';

    // ì €ì¥ëœ ê¸°íšì´ ì—†ìœ¼ë©´
    if (plans.length === 0) {
        planList.innerHTML = '<div class="empty-message">ì•„ì§ ì €ì¥ëœ ê¸°íšì´ ì—†ì–´ìš”. ì²« ë²ˆì§¸ ê¸°íšì„ ë§Œë“¤ì–´ë³´ì„¸ìš”! ğŸ“</div>';
        return;
    }

    // ì €ì¥ëœ ê¸°íšë“¤ì„ ì—­ìˆœìœ¼ë¡œ ë³´ì—¬ì¤˜ìš” (ìµœì‹ ìˆœ)
    plans.reverse().forEach(function(item) {
        // HTML ì¹´ë“œë¥¼ ë§Œë“¤ì–´ìš”
        const card = document.createElement('div');
        card.className = 'plan-card';

        card.innerHTML = `
            <!-- ì œëª© -->
            <h3>${item.title}</h3>
            
            <!-- ê¸°íš ì •ë³´ë“¤ -->
            <div class="plan-info">
                <strong>ğŸ“… ì €ì¥ì¼:</strong> ${item.date}
            </div>
            <div class="plan-info">
                <strong>ğŸ¬ ì¥ë¥´:</strong> ${item.genre}
            </div>
            <div class="plan-info">
                <strong>â±ï¸ ë°©ì†¡ ê¸¸ì´:</strong> ${item.duration}ë¶„
            </div>
            <div class="plan-info">
                <strong>ğŸ‘¥ ì¶œì—°ì:</strong> ${item.cast}
            </div>
            <div class="plan-info">
                <strong>ğŸ’¡ ê¸°íšì•ˆ:</strong> <br>${item.plan}
            </div>
            
            <!-- ì‚­ì œ ë²„íŠ¼ -->
            <button class="btn btn-delete" onclick="deletePlan(${item.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
        `;

        // ë§Œë“  ì¹´ë“œë¥¼ í˜ì´ì§€ì— ì¶”ê°€í•´ìš”
        planList.appendChild(card);
    });
}

// ì…ë ¥ í¼ì„ ë¹„ì›Œì£¼ëŠ” í•¨ìˆ˜
function clearForm() {
    document.getElementById('title').value = '';
    document.getElementById('genre').value = '';
    document.getElementById('duration').value = '';
    document.getElementById('cast').value = '';
    document.getElementById('plan').value = '';
}

// ê¸°íšì„ ì‚­ì œí•˜ëŠ” í•¨ìˆ˜
function deletePlan(id) {
    // ì •ë§ë¡œ ì‚­ì œí• ì§€ í™•ì¸í•´ìš”
    if (confirm('ì •ë§ ì‚­ì œí• ê¹Œìš”? ğŸ˜¢')) {
        // localStorageì—ì„œ ëª¨ë“  ê¸°íšì„ ê°€ì ¸ì™€ìš”
        let plans = JSON.parse(localStorage.getItem('plans')) || [];
        
        // í•´ë‹¹ idì˜ ê¸°íšë§Œ ë¹¼ê³  ë‚˜ë¨¸ì§€ë§Œ ë‚¨ê²¨ìš”
        plans = plans.filter(function(plan) {
            return plan.id !== id;
        });
        
        // ë‹¤ì‹œ ì €ì¥í•´ìš”
        localStorage.setItem('plans', JSON.stringify(plans));
